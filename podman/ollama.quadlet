[Unit]
Description=Ollama (podman)
After=network.target

[Service]
# For rootless deployments prefer: UserNS=keep-id
UserNS=keep-id
Restart=on-failure
Environment=OLLAMA_OPTS=

# Expose port and attach a named volume for models
# The host path depends on your site; for rootless: use a user-owned podman volume
ExecStart=/usr/bin/podman run --rm --name ollama -p 11434:11434 -v ollama_models:/root/.ollama:Z docker.io/ollama/ollama:0.3.0

# Optional ExecStartPost for a host level health probe
ExecStartPost=/bin/sh -c 'for i in 1 2 3; do sleep 1; /usr/bin/curl --fail http://localhost:11434/api/health && exit 0 || true; done; exit 1'
TimeoutStartSec=300

[Install]
WantedBy=multi-user.target
